(LIT "Fixer for execfile.\n\nThis converts usages of the execfile function into calls to the built-in\nexec() function.\n")
(NEWLINE)
(KEYWORD from)
(PUNCT ".")
(PUNCT ".")
(KEYWORD import)
(ID "fixer_base")
(NEWLINE)
(KEYWORD from)
(PUNCT ".")
(PUNCT ".")
(ID "fixer_util")
(KEYWORD import)
(PUNCT "(")
(ID "Comma")
(PUNCT ",")
(ID "Name")
(PUNCT ",")
(ID "Call")
(PUNCT ",")
(ID "LParen")
(PUNCT ",")
(ID "RParen")
(PUNCT ",")
(ID "Dot")
(PUNCT ",")
(ID "Node")
(PUNCT ",")
(ID "ArgList")
(PUNCT ",")
(ID "String")
(PUNCT ",")
(ID "syms")
(PUNCT ")")
(NEWLINE)
(KEYWORD class)
(ID "FixExecfile")
(PUNCT "(")
(ID "fixer_base")
(PUNCT ".")
(ID "BaseFix")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "BM_compatible")
(PUNCT "=")
(KEYWORD True)
(NEWLINE)
(ID "PATTERN")
(PUNCT "=")
(LIT "\n    power< 'execfile' trailer< '(' arglist< filename=any [',' globals=any [',' locals=any ] ] > ')' > >\n    |\n    power< 'execfile' trailer< '(' filename=any ')' > >\n    ")
(NEWLINE)
(KEYWORD def)
(ID "transform")
(PUNCT "(")
(ID "self")
(PUNCT ",")
(ID "node")
(PUNCT ",")
(ID "results")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD assert)
(ID "results")
(NEWLINE)
(ID "filename")
(PUNCT "=")
(ID "results")
(PUNCT "[")
(LIT "filename")
(PUNCT "]")
(NEWLINE)
(ID "globals")
(PUNCT "=")
(ID "results")
(PUNCT ".")
(ID "get")
(PUNCT "(")
(LIT "globals")
(PUNCT ")")
(NEWLINE)
(ID "locals")
(PUNCT "=")
(ID "results")
(PUNCT ".")
(ID "get")
(PUNCT "(")
(LIT "locals")
(PUNCT ")")
(NEWLINE)
(ID "execfile_paren")
(PUNCT "=")
(ID "node")
(PUNCT ".")
(ID "children")
(PUNCT "[")
(PUNCT "-")
(LIT 1)
(PUNCT "]")
(PUNCT ".")
(ID "children")
(PUNCT "[")
(PUNCT "-")
(LIT 1)
(PUNCT "]")
(PUNCT ".")
(ID "clone")
(PUNCT "(")
(PUNCT ")")
(NEWLINE)
(ID "open_args")
(PUNCT "=")
(ID "ArgList")
(PUNCT "(")
(PUNCT "[")
(ID "filename")
(PUNCT ".")
(ID "clone")
(PUNCT "(")
(PUNCT ")")
(PUNCT "]")
(PUNCT ",")
(ID "rparen")
(PUNCT "=")
(ID "execfile_paren")
(PUNCT ")")
(NEWLINE)
(ID "open_call")
(PUNCT "=")
(ID "Node")
(PUNCT "(")
(ID "syms")
(PUNCT ".")
(ID "power")
(PUNCT ",")
(PUNCT "[")
(ID "Name")
(PUNCT "(")
(LIT "open")
(PUNCT ")")
(PUNCT ",")
(ID "open_args")
(PUNCT "]")
(PUNCT ")")
(NEWLINE)
(ID "read")
(PUNCT "=")
(PUNCT "[")
(ID "Node")
(PUNCT "(")
(ID "syms")
(PUNCT ".")
(ID "trailer")
(PUNCT ",")
(PUNCT "[")
(ID "Dot")
(PUNCT "(")
(PUNCT ")")
(PUNCT ",")
(ID "Name")
(PUNCT "(")
(LIT "read")
(PUNCT ")")
(PUNCT "]")
(PUNCT ")")
(PUNCT ",")
(ID "Node")
(PUNCT "(")
(ID "syms")
(PUNCT ".")
(ID "trailer")
(PUNCT ",")
(PUNCT "[")
(ID "LParen")
(PUNCT "(")
(PUNCT ")")
(PUNCT ",")
(ID "RParen")
(PUNCT "(")
(PUNCT ")")
(PUNCT "]")
(PUNCT ")")
(PUNCT "]")
(NEWLINE)
(ID "open_expr")
(PUNCT "=")
(PUNCT "[")
(ID "open_call")
(PUNCT "]")
(PUNCT "+")
(ID "read")
(NEWLINE)
(ID "filename_arg")
(PUNCT "=")
(ID "filename")
(PUNCT ".")
(ID "clone")
(PUNCT "(")
(PUNCT ")")
(NEWLINE)
(ID "filename_arg")
(PUNCT ".")
(ID "prefix")
(PUNCT "=")
(LIT " ")
(NEWLINE)
(ID "exec_str")
(PUNCT "=")
(ID "String")
(PUNCT "(")
(LIT "'exec'")
(PUNCT ",")
(LIT " ")
(PUNCT ")")
(NEWLINE)
(ID "compile_args")
(PUNCT "=")
(ID "open_expr")
(PUNCT "+")
(PUNCT "[")
(ID "Comma")
(PUNCT "(")
(PUNCT ")")
(PUNCT ",")
(ID "filename_arg")
(PUNCT ",")
(ID "Comma")
(PUNCT "(")
(PUNCT ")")
(PUNCT ",")
(ID "exec_str")
(PUNCT "]")
(NEWLINE)
(ID "compile_call")
(PUNCT "=")
(ID "Call")
(PUNCT "(")
(ID "Name")
(PUNCT "(")
(LIT "compile")
(PUNCT ")")
(PUNCT ",")
(ID "compile_args")
(PUNCT ",")
(LIT "")
(PUNCT ")")
(NEWLINE)
(ID "args")
(PUNCT "=")
(PUNCT "[")
(ID "compile_call")
(PUNCT "]")
(NEWLINE)
(KEYWORD if)
(ID "globals")
(KEYWORD is)
(KEYWORD not)
(KEYWORD None)
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "args")
(PUNCT ".")
(ID "extend")
(PUNCT "(")
(PUNCT "[")
(ID "Comma")
(PUNCT "(")
(PUNCT ")")
(PUNCT ",")
(ID "globals")
(PUNCT ".")
(ID "clone")
(PUNCT "(")
(PUNCT ")")
(PUNCT "]")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(KEYWORD if)
(ID "locals")
(KEYWORD is)
(KEYWORD not)
(KEYWORD None)
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "args")
(PUNCT ".")
(ID "extend")
(PUNCT "(")
(PUNCT "[")
(ID "Comma")
(PUNCT "(")
(PUNCT ")")
(PUNCT ",")
(ID "locals")
(PUNCT ".")
(ID "clone")
(PUNCT "(")
(PUNCT ")")
(PUNCT "]")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(KEYWORD return)
(ID "Call")
(PUNCT "(")
(ID "Name")
(PUNCT "(")
(LIT "exec")
(PUNCT ")")
(PUNCT ",")
(ID "args")
(PUNCT ",")
(ID "prefix")
(PUNCT "=")
(ID "node")
(PUNCT ".")
(ID "prefix")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(DEDENT)
(ENDMARKER)
