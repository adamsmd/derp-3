(LIT "Recognize image file formats based on their first few bytes.")
(NEWLINE)
(ID "__all__")
(PUNCT "=")
(PUNCT "[")
(LIT "what")
(PUNCT "]")
(NEWLINE)
(KEYWORD def)
(ID "what")
(PUNCT "(")
(ID "file")
(PUNCT ",")
(ID "h")
(PUNCT "=")
(KEYWORD None)
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "f")
(PUNCT "=")
(KEYWORD None)
(NEWLINE)
(KEYWORD try)
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD if)
(ID "h")
(KEYWORD is)
(KEYWORD None)
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD if)
(ID "isinstance")
(PUNCT "(")
(ID "file")
(PUNCT ",")
(ID "str")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "f")
(PUNCT "=")
(ID "open")
(PUNCT "(")
(ID "file")
(PUNCT ",")
(LIT "rb")
(PUNCT ")")
(NEWLINE)
(ID "h")
(PUNCT "=")
(ID "f")
(PUNCT ".")
(ID "read")
(PUNCT "(")
(LIT 32)
(PUNCT ")")
(NEWLINE)
(DEDENT)
(KEYWORD else)
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "location")
(PUNCT "=")
(ID "file")
(PUNCT ".")
(ID "tell")
(PUNCT "(")
(PUNCT ")")
(NEWLINE)
(ID "h")
(PUNCT "=")
(ID "file")
(PUNCT ".")
(ID "read")
(PUNCT "(")
(LIT 32)
(PUNCT ")")
(NEWLINE)
(ID "file")
(PUNCT ".")
(ID "seek")
(PUNCT "(")
(ID "location")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(DEDENT)
(KEYWORD for)
(ID "tf")
(KEYWORD in)
(ID "tests")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "res")
(PUNCT "=")
(ID "tf")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(NEWLINE)
(KEYWORD if)
(ID "res")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(ID "res")
(NEWLINE)
(DEDENT)
(DEDENT)
(DEDENT)
(KEYWORD finally)
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD if)
(ID "f")
(PUNCT ":")
(ID "f")
(PUNCT ".")
(ID "close")
(PUNCT "(")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(KEYWORD return)
(KEYWORD None)
(NEWLINE)
(DEDENT)
(ID "tests")
(PUNCT "=")
(PUNCT "[")
(PUNCT "]")
(NEWLINE)
(KEYWORD def)
(ID "test_jpeg")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(LIT "JPEG data in JFIF or Exif format")
(NEWLINE)
(KEYWORD if)
(ID "h")
(PUNCT "[")
(LIT 6)
(PUNCT ":")
(LIT 10)
(PUNCT "]")
(KEYWORD in)
(PUNCT "(")
(LIT #"JFIF")
(PUNCT ",")
(LIT #"Exif")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "jpeg")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_jpeg")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test_png")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD if)
(ID "h")
(PUNCT ".")
(ID "startswith")
(PUNCT "(")
(LIT #"\211PNG\r\n\32\n")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "png")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_png")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test_gif")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(LIT "GIF ('87 and '89 variants)")
(NEWLINE)
(KEYWORD if)
(ID "h")
(PUNCT "[")
(PUNCT ":")
(LIT 6)
(PUNCT "]")
(KEYWORD in)
(PUNCT "(")
(LIT #"GIF87a")
(PUNCT ",")
(LIT #"GIF89a")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "gif")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_gif")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test_tiff")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(LIT "TIFF (can be in Motorola or Intel byte order)")
(NEWLINE)
(KEYWORD if)
(ID "h")
(PUNCT "[")
(PUNCT ":")
(LIT 2)
(PUNCT "]")
(KEYWORD in)
(PUNCT "(")
(LIT #"MM")
(PUNCT ",")
(LIT #"II")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "tiff")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_tiff")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test_rgb")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(LIT "SGI image library")
(NEWLINE)
(KEYWORD if)
(ID "h")
(PUNCT ".")
(ID "startswith")
(PUNCT "(")
(LIT #"\1\332")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "rgb")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_rgb")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test_pbm")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(LIT "PBM (portable bitmap)")
(NEWLINE)
(KEYWORD if)
(ID "len")
(PUNCT "(")
(ID "h")
(PUNCT ")")
(PUNCT ">=")
(LIT 3)
(KEYWORD and)
(ID "h")
(PUNCT "[")
(LIT 0)
(PUNCT "]")
(PUNCT "==")
(ID "ord")
(PUNCT "(")
(LIT #"P")
(PUNCT ")")
(KEYWORD and)
(ID "h")
(PUNCT "[")
(LIT 1)
(PUNCT "]")
(KEYWORD in)
(LIT #"14")
(KEYWORD and)
(ID "h")
(PUNCT "[")
(LIT 2)
(PUNCT "]")
(KEYWORD in)
(LIT #" \t\n\r")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "pbm")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_pbm")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test_pgm")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(LIT "PGM (portable graymap)")
(NEWLINE)
(KEYWORD if)
(ID "len")
(PUNCT "(")
(ID "h")
(PUNCT ")")
(PUNCT ">=")
(LIT 3)
(KEYWORD and)
(ID "h")
(PUNCT "[")
(LIT 0)
(PUNCT "]")
(PUNCT "==")
(ID "ord")
(PUNCT "(")
(LIT #"P")
(PUNCT ")")
(KEYWORD and)
(ID "h")
(PUNCT "[")
(LIT 1)
(PUNCT "]")
(KEYWORD in)
(LIT #"25")
(KEYWORD and)
(ID "h")
(PUNCT "[")
(LIT 2)
(PUNCT "]")
(KEYWORD in)
(LIT #" \t\n\r")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "pgm")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_pgm")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test_ppm")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(LIT "PPM (portable pixmap)")
(NEWLINE)
(KEYWORD if)
(ID "len")
(PUNCT "(")
(ID "h")
(PUNCT ")")
(PUNCT ">=")
(LIT 3)
(KEYWORD and)
(ID "h")
(PUNCT "[")
(LIT 0)
(PUNCT "]")
(PUNCT "==")
(ID "ord")
(PUNCT "(")
(LIT #"P")
(PUNCT ")")
(KEYWORD and)
(ID "h")
(PUNCT "[")
(LIT 1)
(PUNCT "]")
(KEYWORD in)
(LIT #"36")
(KEYWORD and)
(ID "h")
(PUNCT "[")
(LIT 2)
(PUNCT "]")
(KEYWORD in)
(LIT #" \t\n\r")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "ppm")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_ppm")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test_rast")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(LIT "Sun raster file")
(NEWLINE)
(KEYWORD if)
(ID "h")
(PUNCT ".")
(ID "startswith")
(PUNCT "(")
(LIT #"Y\246j\225")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "rast")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_rast")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test_xbm")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(LIT "X bitmap (X10 or X11)")
(NEWLINE)
(KEYWORD if)
(ID "h")
(PUNCT ".")
(ID "startswith")
(PUNCT "(")
(LIT #"#define ")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "xbm")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_xbm")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test_bmp")
(PUNCT "(")
(ID "h")
(PUNCT ",")
(ID "f")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD if)
(ID "h")
(PUNCT ".")
(ID "startswith")
(PUNCT "(")
(LIT #"BM")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD return)
(LIT "bmp")
(NEWLINE)
(DEDENT)
(DEDENT)
(ID "tests")
(PUNCT ".")
(ID "append")
(PUNCT "(")
(ID "test_bmp")
(PUNCT ")")
(NEWLINE)
(KEYWORD def)
(ID "test")
(PUNCT "(")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD import)
(ID "sys")
(NEWLINE)
(ID "recursive")
(PUNCT "=")
(LIT 0)
(NEWLINE)
(KEYWORD if)
(ID "sys")
(PUNCT ".")
(ID "argv")
(PUNCT "[")
(LIT 1)
(PUNCT ":")
(PUNCT "]")
(KEYWORD and)
(ID "sys")
(PUNCT ".")
(ID "argv")
(PUNCT "[")
(LIT 1)
(PUNCT "]")
(PUNCT "==")
(LIT "-r")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD del)
(ID "sys")
(PUNCT ".")
(ID "argv")
(PUNCT "[")
(LIT 1)
(PUNCT ":")
(LIT 2)
(PUNCT "]")
(NEWLINE)
(ID "recursive")
(PUNCT "=")
(LIT 1)
(NEWLINE)
(DEDENT)
(KEYWORD try)
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD if)
(ID "sys")
(PUNCT ".")
(ID "argv")
(PUNCT "[")
(LIT 1)
(PUNCT ":")
(PUNCT "]")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "testall")
(PUNCT "(")
(ID "sys")
(PUNCT ".")
(ID "argv")
(PUNCT "[")
(LIT 1)
(PUNCT ":")
(PUNCT "]")
(PUNCT ",")
(ID "recursive")
(PUNCT ",")
(LIT 1)
(PUNCT ")")
(NEWLINE)
(DEDENT)
(KEYWORD else)
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "testall")
(PUNCT "(")
(PUNCT "[")
(LIT ".")
(PUNCT "]")
(PUNCT ",")
(ID "recursive")
(PUNCT ",")
(LIT 1)
(PUNCT ")")
(NEWLINE)
(DEDENT)
(DEDENT)
(KEYWORD except)
(ID "KeyboardInterrupt")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "sys")
(PUNCT ".")
(ID "stderr")
(PUNCT ".")
(ID "write")
(PUNCT "(")
(LIT "\n[Interrupted]\n")
(PUNCT ")")
(NEWLINE)
(ID "sys")
(PUNCT ".")
(ID "exit")
(PUNCT "(")
(LIT 1)
(PUNCT ")")
(NEWLINE)
(DEDENT)
(DEDENT)
(KEYWORD def)
(ID "testall")
(PUNCT "(")
(ID "list")
(PUNCT ",")
(ID "recursive")
(PUNCT ",")
(ID "toplevel")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD import)
(ID "sys")
(NEWLINE)
(KEYWORD import)
(ID "os")
(NEWLINE)
(KEYWORD for)
(ID "filename")
(KEYWORD in)
(ID "list")
(PUNCT ":")
(NEWLINE)
(INDENT)
(KEYWORD if)
(ID "os")
(PUNCT ".")
(ID "path")
(PUNCT ".")
(ID "isdir")
(PUNCT "(")
(ID "filename")
(PUNCT ")")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "print")
(PUNCT "(")
(ID "filename")
(PUNCT "+")
(LIT "/:")
(PUNCT ",")
(ID "end")
(PUNCT "=")
(LIT " ")
(PUNCT ")")
(NEWLINE)
(KEYWORD if)
(ID "recursive")
(KEYWORD or)
(ID "toplevel")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "print")
(PUNCT "(")
(LIT "recursing down:")
(PUNCT ")")
(NEWLINE)
(KEYWORD import)
(ID "glob")
(NEWLINE)
(ID "names")
(PUNCT "=")
(ID "glob")
(PUNCT ".")
(ID "glob")
(PUNCT "(")
(ID "os")
(PUNCT ".")
(ID "path")
(PUNCT ".")
(ID "join")
(PUNCT "(")
(ID "filename")
(PUNCT ",")
(LIT "*")
(PUNCT ")")
(PUNCT ")")
(NEWLINE)
(ID "testall")
(PUNCT "(")
(ID "names")
(PUNCT ",")
(ID "recursive")
(PUNCT ",")
(LIT 0)
(PUNCT ")")
(NEWLINE)
(DEDENT)
(KEYWORD else)
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "print")
(PUNCT "(")
(LIT "*** directory (use -r) ***")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(DEDENT)
(KEYWORD else)
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "print")
(PUNCT "(")
(ID "filename")
(PUNCT "+")
(LIT ":")
(PUNCT ",")
(ID "end")
(PUNCT "=")
(LIT " ")
(PUNCT ")")
(NEWLINE)
(ID "sys")
(PUNCT ".")
(ID "stdout")
(PUNCT ".")
(ID "flush")
(PUNCT "(")
(PUNCT ")")
(NEWLINE)
(KEYWORD try)
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "print")
(PUNCT "(")
(ID "what")
(PUNCT "(")
(ID "filename")
(PUNCT ")")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(KEYWORD except)
(ID "OSError")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "print")
(PUNCT "(")
(LIT "*** not found ***")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(DEDENT)
(DEDENT)
(DEDENT)
(KEYWORD if)
(ID "__name__")
(PUNCT "==")
(LIT "__main__")
(PUNCT ":")
(NEWLINE)
(INDENT)
(ID "test")
(PUNCT "(")
(PUNCT ")")
(NEWLINE)
(DEDENT)
(ENDMARKER)
